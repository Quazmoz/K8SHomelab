[
    {
        "id": "groupme_tool",
        "name": "GroupMe Tool",
        "content": "import os\nimport requests\nimport json\nfrom pydantic import BaseModel, Field\n\nclass Tools:\n    # 1. Global Valves (Admin Settings)\n    class Valves(BaseModel):\n        MCP_SERVER_URL: str = Field(\n            default=\"http://groupme-backend.apps.svc.cluster.local:5000/tool/execute\",\n            description=\"The internal URL of the GroupMe MCP Server tool execution endpoint\"\n        )\n\n    # 2. User Valves (Per-User Secure Settings)\n    class UserValves(BaseModel):\n        GROUPME_TOKEN: str = Field(\n            default=\"\", \n            description=\"Your GroupMe Access Token. Get it from dev.groupme.com\"\n        )\n\n    def __init__(self):\n        self.valves = self.Valves()\n\n    # 3. Wrapper Helper\n    async def _call_mcp(self, tool_name: str, arguments: dict, token: str) -> str:\n        if not token:\n            return \"Error: Please configure your GroupMe Token in the Tool Settings (Gear Icon).\"\n        \n        url = self.valves.MCP_SERVER_URL\n        headers = {\n            \"Content-Type\": \"application/json\",\n            \"X-GroupMe-Access-Token\": token # Secure injection\n        }\n        \n        payload = {\n            \"name\": tool_name,\n            \"arguments\": arguments\n        }\n        try:\n            # Using sync requests with timeout\n            response = requests.post(url, headers=headers, json=payload, timeout=30)\n            response.raise_for_status()\n            \n            # MCP returns a result object, usually list of Content items\n            return json.dumps(response.json(), indent=2)\n        except Exception as e:\n            return f\"Failed to execute {tool_name}: {str(e)}\"\n\n    # --- Tool Definitions ---\n\n    def _get_token(self, __user__: dict) -> str:\n        \"\"\"Extract token from __user__ dict safely.\"\"\"\n        valves = __user__.get(\"valves\") if isinstance(__user__, dict) else None\n        if valves and hasattr(valves, \"GROUPME_TOKEN\"):\n            return valves.GROUPME_TOKEN\n        return \"\"\n\n    async def list_groups(self, __user__: dict = {}) -> str:\n        \"\"\"\n        List your GroupMe groups to get group_id.\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_list_groups\", {}, token)\n\n    async def list_messages(self, group_id: str, __user__: dict = {}) -> str:\n        \"\"\"\n        List messages from a group.\n        :param group_id: The ID of the group\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_list_messages\", {\"group_id\": group_id}, token)\n\n    async def send_message(self, group_id: str, text: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Send a message to a group.\n        :param group_id: The ID of the group\n        :param text: The content of the message\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_send_message\", {\"group_id\": group_id, \"text\": text}, token)\n\n    async def list_polls(self, group_id: str, status: str = \"active\", __user__: dict = {}) -> str:\n        \"\"\"\n        List polls in a group.\n        :param group_id: The ID of the group\n        :param status: Filter by 'active', 'past', or 'all'\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_list_polls\", {\"group_id\": group_id, \"status\": status}, token)\n\n    async def create_poll(self, group_id: str, subject: str, options: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Create a new poll.\n        :param group_id: The ID of the group\n        :param subject: The question to ask\n        :param options: Comma-separated list of options (e.g. \"Yes,No,Maybe\")\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_create_poll\", {\"group_id\": group_id, \"subject\": subject, \"options\": options}, token)\n\n    async def get_poll(self, group_id: str, poll_id: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Get details of a specific poll.\n        :param group_id: The ID of the group\n        :param poll_id: The ID of the poll\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_get_poll\", {\"group_id\": group_id, \"poll_id\": poll_id}, token)\n\n    # --- DM Tools ---\n\n    async def list_chats(self, __user__: dict = {}) -> str:\n        \"\"\"\n        List your direct message conversations.\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_list_chats\", {}, token)\n\n    async def list_dm_messages(self, other_user_id: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Get messages from a DM conversation.\n        :param other_user_id: The user ID of the other person\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_list_dm_messages\", {\"other_user_id\": other_user_id}, token)\n\n    async def send_dm(self, recipient_id: str, text: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Send a direct message.\n        :param recipient_id: The user ID to send to\n        :param text: Message text\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_send_dm\", {\"recipient_id\": recipient_id, \"text\": text}, token)\n\n    # --- Bot Tools ---\n\n    async def list_bots(self, __user__: dict = {}) -> str:\n        \"\"\"\n        List all your bots.\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_list_bots\", {}, token)\n\n    async def post_bot_message(self, bot_id: str, text: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Post a message as a bot.\n        :param bot_id: The ID of the bot\n        :param text: Message text\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_post_bot_message\", {\"bot_id\": bot_id, \"text\": text}, token)\n\n    # --- Member Tools ---\n\n    async def list_group_members(self, group_id: str, __user__: dict = {}) -> str:\n        \"\"\"\n        List members of a group.\n        :param group_id: ID of the group\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_list_group_members\", {\"group_id\": group_id}, token)\n    \n    async def remove_member(self, group_id: str, member_id: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Remove a member from a group.\n        :param group_id: ID of the group\n        :param member_id: ID of the member to remove\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_remove_member\", {\"group_id\": group_id, \"member_id\": member_id}, token)\n\n    async def who_is(self, name: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Find a person across all your groups and DMs.\n        :param name: Name to search for\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_who_is\", {\"name\": name}, token)\n\n    # --- Block Tools ---\n\n    async def list_blocks(self, user_id: str, __user__: dict = {}) -> str:\n        \"\"\"\n        List users you have blocked.\n        :param user_id: Your user ID (get from get_current_user)\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_list_blocks\", {\"user_id\": user_id}, token)\n\n    async def get_current_user(self, __user__: dict = {}) -> str:\n        \"\"\"\n        Get your own user details.\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_get_current_user\", {}, token)\n\n    async def block_user(self, my_user_id: str, other_user_id: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Block a user.\n        :param my_user_id: Your user ID (get from get_current_user)\n        :param other_user_id: The ID of the person to block\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_block_user\", {\"user_id\": my_user_id, \"other_user_id\": other_user_id}, token)\n\n    async def unblock_user(self, my_user_id: str, other_user_id: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Unblock a user.\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_unblock_user\", {\"user_id\": my_user_id, \"other_user_id\": other_user_id}, token)\n\n    # --- Group Management ---\n\n    async def list_former_groups(self, __user__: dict = {}) -> str:\n        \"\"\"\n        List groups you have left.\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_list_former_groups\", {}, token)\n\n    async def rejoin_group(self, group_id: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Rejoin a group you previously left.\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_rejoin_group\", {\"group_id\": group_id}, token)\n\n    # --- Advanced / Missing Tools ---\n\n    async def create_bot(self, name: str, group_id: str, callback_url: str = None, __user__: dict = {}) -> str:\n        \"\"\"\n        Create a bot.\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_create_bot\", {\"name\": name, \"group_id\": group_id, \"callback_url\": callback_url}, token)\n\n    async def destroy_bot(self, bot_id: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Delete a bot.\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_destroy_bot\", {\"bot_id\": bot_id}, token)\n\n    async def update_group(self, group_id: str, name: str = None, description: str = None, image_url: str = None, share: bool = None, __user__: dict = {}) -> str:\n        \"\"\"\n        Update a group's details.\n        \"\"\"\n        token = self._get_token(__user__)\n        args = {\"group_id\": group_id}\n        if name: args[\"name\"] = name\n        if description: args[\"description\"] = description\n        if image_url: args[\"image_url\"] = image_url\n        if share is not None: args[\"share\"] = share\n        return await self._call_mcp(\"groupme_update_group\", args, token)\n\n    async def destroy_group(self, group_id: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Delete a group (if you are the owner).\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_destroy_group\", {\"group_id\": group_id}, token)\n\n    async def update_group_nickname(self, group_id: str, nickname: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Change your nickname in a specific group.\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_update_group_nickname\", {\"group_id\": group_id, \"nickname\": nickname}, token)\n\n    async def like_message(self, conversation_id: str, message_id: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Like a message.\n        :param conversation_id: Group ID or Chat ID\n        :param message_id: The ID of the message\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_like_message\", {\"conversation_id\": conversation_id, \"message_id\": message_id}, token)\n\n    async def unlike_message(self, conversation_id: str, message_id: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Unlike a message.\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_unlike_message\", {\"conversation_id\": conversation_id, \"message_id\": message_id}, token)\n\n    async def search_messages(self, group_id: str, query: str, __user__: dict = {}) -> str:\n        \"\"\"\n        Search for messages in a group.\n        \"\"\"\n        token = self._get_token(__user__)\n        return await self._call_mcp(\"groupme_search_messages\", {\"group_id\": group_id, \"query\": query}, token)\n\n",
        "description": "Secure GroupMe Integration via MCP with UserValves.",
        "access_control": null,
        "meta": {
            "description": "Manage your GroupMe groups, polls, and messages securely using your personal Access Token.",
            "manifest": {
                "title": "GroupMe Tool",
                "url": "https://groupme.com",
                "version": "1.0.1",
                "author": "Antigravity",
                "description": "Secure GroupMe Integration via MCP with UserValves."
            }
        }
    }
]