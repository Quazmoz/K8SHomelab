# OpenWebUI Advanced Metrics Dashboard
# Deep insights: models, files, knowledge bases, and tools
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboard-openwebui-advanced
  namespace: apps
  labels:
    grafana_dashboard: "1"
data:
  openwebui-advanced.json: |-
    {
      "annotations": { "list": [] },
      "editable": true,
      "fiscalYearStartMonth": 0,
      "graphTooltip": 1,
      "id": null,
      "links": [
        {
          "asDropdown": false,
          "icon": "dashboard",
          "includeVars": false,
          "keepTime": true,
          "tags": ["openwebui"],
          "title": "OpenWebUI Dashboards",
          "type": "dashboards"
        },
        {
          "asDropdown": false,
          "icon": "external link",
          "targetBlank": false,
          "title": "üè† Overview",
          "type": "link",
          "url": "/d/homelab-overview"
        }
      ],
      "panels": [
        {
          "id": 1,
          "gridPos": { "h": 3, "w": 24, "x": 0, "y": 0 },
          "type": "text",
          "title": "",
          "options": {
            "mode": "html",
            "content": "<div style='text-align: center; padding: 10px; background: linear-gradient(135deg, #f97316 0%, #ea580c 100%); border-radius: 8px;'><h1 style='margin: 0; color: #fff;'>üß† OpenWebUI Advanced Metrics</h1><p style='margin: 5px 0 0 0; color: rgba(255,255,255,0.9);'>Models ‚Ä¢ Knowledge Bases ‚Ä¢ Files ‚Ä¢ Tools</p></div>"
          }
        },
        {
          "id": 2,
          "gridPos": { "h": 4, "w": 4, "x": 0, "y": 3 },
          "type": "stat",
          "title": "Custom Models",
          "description": "Number of custom model configurations created in OpenWebUI. These are user-defined model aliases or configurations that wrap base LLM models with custom system prompts, parameters, or settings.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT COUNT(*) FROM model",
              "format": "table"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "fixed", "fixedColor": "orange" }
            }
          }
        },
        {
          "id": 3,
          "gridPos": { "h": 4, "w": 4, "x": 4, "y": 3 },
          "type": "stat",
          "title": "Knowledge Bases",
          "description": "Number of RAG (Retrieval Augmented Generation) knowledge bases configured. Knowledge bases contain documents that can be searched during conversations to provide context-aware responses.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT COUNT(*) FROM knowledge",
              "format": "table"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "fixed", "fixedColor": "blue" }
            }
          }
        },
        {
          "id": 4,
          "gridPos": { "h": 4, "w": 4, "x": 8, "y": 3 },
          "type": "stat",
          "title": "Documents",
          "description": "Total number of documents indexed for search and retrieval. Documents are parsed text files used for knowledge base queries and context injection.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT COUNT(*) FROM document",
              "format": "table"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "fixed", "fixedColor": "green" }
            }
          }
        },
        {
          "id": 5,
          "gridPos": { "h": 4, "w": 4, "x": 12, "y": 3 },
          "type": "stat",
          "title": "Uploaded Files",
          "description": "Total files uploaded by users including images, PDFs, and other attachments. These files can be used in conversations or added to knowledge bases.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT COUNT(*) FROM file",
              "format": "table"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "fixed", "fixedColor": "purple" }
            }
          }
        },
        {
          "id": 6,
          "gridPos": { "h": 4, "w": 4, "x": 16, "y": 3 },
          "type": "stat",
          "title": "Custom Tools",
          "description": "Number of custom function-calling tools created. Tools extend LLM capabilities by allowing models to execute code, call APIs, or perform actions during conversations.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT COUNT(*) FROM tool",
              "format": "table"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "fixed", "fixedColor": "yellow" }
            }
          }
        },
        {
          "id": 7,
          "gridPos": { "h": 4, "w": 4, "x": 20, "y": 3 },
          "type": "stat",
          "title": "Saved Prompts",
          "description": "Number of reusable prompt templates saved in the prompt library. Prompts can be quickly inserted into conversations using slash commands.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT COUNT(*) FROM prompt",
              "format": "table"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "fixed", "fixedColor": "red" }
            }
          }
        },
        {
          "id": 8,
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 7 },
          "type": "piechart",
          "title": "Model Usage by Chat Count",
          "description": "Distribution of which AI models are being used across all conversations. Shows the top 10 most frequently used models based on chat session metadata. Helps identify popular models and usage patterns.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT REGEXP_REPLACE(COALESCE(meta->>'model', 'Unknown'), '^models/', '') as model, COUNT(*) as chats FROM chat WHERE meta->>'model' IS NOT NULL GROUP BY meta->>'model' ORDER BY chats DESC LIMIT 10",
              "format": "table"
            }
          ],
          "options": {
            "legend": { "displayMode": "table", "placement": "right", "showLegend": true },
            "pieType": "donut",
            "reduceOptions": { "calcs": ["sum"], "fields": "", "values": true },
            "displayLabels": ["percent"]
          }
        },
        {
          "id": 9,
          "gridPos": { "h": 8, "w": 12, "x": 12, "y": 7 },
          "type": "table",
          "title": "Configured Models",
          "description": "List of custom model configurations created in OpenWebUI. Shows the model name, the underlying base model ID (the actual LLM being used), and when it was created. Custom models allow setting default system prompts and parameters.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT name as \"Model Name\", base_model_id as \"Base Model\" FROM model ORDER BY updated_at DESC LIMIT 15",
              "format": "table"
            }
          ]
        },
        {
          "id": 10,
          "gridPos": { "h": 4, "w": 6, "x": 0, "y": 15 },
          "type": "stat",
          "title": "Total Feedback",
          "description": "Number of thumbs up/down feedback ratings left by users on AI responses. Feedback helps track response quality and can be used to improve model performance over time.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT COUNT(*) FROM feedback",
              "format": "table"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "fixed", "fixedColor": "blue" }
            }
          }
        },
        {
          "id": 11,
          "gridPos": { "h": 4, "w": 6, "x": 6, "y": 15 },
          "type": "stat",
          "title": "Unique Tags",
          "description": "Number of unique tags created for organizing conversations. Tags allow users to categorize and filter their chat history for easier navigation.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT COUNT(*) FROM tag",
              "format": "table"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "fixed", "fixedColor": "purple" }
            }
          }
        },
        {
          "id": 12,
          "gridPos": { "h": 4, "w": 6, "x": 12, "y": 15 },
          "type": "stat",
          "title": "User Memories",
          "description": "Number of memory entries stored for users. Memories allow the AI to remember facts about users across conversations, enabling more personalized interactions.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT COUNT(*) FROM memory",
              "format": "table"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "fixed", "fixedColor": "green" }
            }
          }
        },
        {
          "id": 13,
          "gridPos": { "h": 4, "w": 6, "x": 18, "y": 15 },
          "type": "stat",
          "title": "Functions",
          "description": "Number of custom functions registered. Functions are Python code snippets that can be called by models to extend their capabilities with custom logic or API integrations.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT COUNT(*) FROM function",
              "format": "table"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "fixed", "fixedColor": "red" }
            }
          }
        },
        {
          "id": 14,
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 19 },
          "type": "table",
          "title": "Knowledge Bases",
          "description": "List of RAG knowledge bases with their names and descriptions. Knowledge bases enable the AI to search through your documents during conversations to provide accurate, contextual answers.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT name as \"Name\", description as \"Description\" FROM knowledge ORDER BY updated_at DESC LIMIT 10",
              "format": "table"
            }
          ]
        },
        {
          "id": 15,
          "gridPos": { "h": 8, "w": 12, "x": 12, "y": 19 },
          "type": "table",
          "title": "Recent Files",
          "description": "Most recently uploaded files showing filename and upload timestamp. Files can include images, PDFs, code files, and other documents that users share in conversations.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT filename as \"Filename\" FROM file ORDER BY updated_at DESC LIMIT 15",
              "format": "table"
            }
          ]
        },
        {
          "id": 16,
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 27 },
          "type": "table",
          "title": "Custom Tools",
          "description": "List of function-calling tools available to AI models. Tools enable models to perform actions like web searches, code execution, API calls, and other external integrations during conversations.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT id as \"Tool ID\", name as \"Name\" FROM tool ORDER BY updated_at DESC LIMIT 15",
              "format": "table"
            }
          ]
        },
        {
          "id": 17,
          "gridPos": { "h": 8, "w": 12, "x": 12, "y": 27 },
          "type": "table",
          "title": "Tags",
          "description": "Organization tags created by users to categorize their conversations. Tags enable filtering and grouping of related chats for better organization.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT name as \"Tag Name\", user_id as \"User ID\" FROM tag ORDER BY name LIMIT 20",
              "format": "table"
            }
          ]
        },
        {
          "id": 18,
          "gridPos": { "h": 8, "w": 24, "x": 0, "y": 35 },
          "type": "timeseries",
          "title": "File Uploads Over Time",
          "description": "Daily trend of file uploads over the last 30 days. Shows upload activity patterns and can help identify peak usage periods or trends in file sharing behavior.",
          "datasource": { "type": "postgres", "uid": "PostgreSQL-OpenWebUI" },
          "targets": [
            {
              "refId": "A",
              "rawSql": "SELECT date_trunc('day', to_timestamp(updated_at / 1000000000.0)) as time, COUNT(*) as \"Uploads\" FROM file WHERE to_timestamp(updated_at / 1000000000.0) > NOW() - INTERVAL '30 days' GROUP BY time ORDER BY time",
              "format": "time_series"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "unit": "short",
              "color": { "mode": "fixed", "fixedColor": "purple" },
              "custom": { 
                "fillOpacity": 30, 
                "lineWidth": 2, 
                "drawStyle": "bars",
                "spanNulls": true
              }
            }
          }
        }
      ],
      "refresh": "1m",
      "schemaVersion": 39,
      "tags": ["openwebui", "ai", "models", "advanced"],
      "templating": { "list": [] },
      "time": { "from": "now-30d", "to": "now" },
      "title": "OpenWebUI Advanced",
      "uid": "openwebui-advanced",
      "version": 4
    }

